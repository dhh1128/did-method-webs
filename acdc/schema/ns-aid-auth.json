{
    "$id": <Insert Schema SAID>,
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Identifier Authorization attestation",
    "description": "An Authorization attestation by an AID controller, to acknowledge and authorize a namespaced identifier whose AID post-fix matches the controller AID.",
    "type": "object",
    "credentialType": "IdentifierAuthorizationAttestation",
    "version": "1.0.0",
    "properties": {
        "v": {
            "description": "Version",
            "type": "string"
        },
        "d": {
            "description": "Attestation SAID",
            "type": "string"
        },
        "u": {
            "description": "One time use nonce",
            "type": "string"
        },
        "i": {
            "description": "Controller AID",
            "type": "string"
        },
        "ri": {
            "description": "Attestation status registry",
            "type": "string"
        },
        "s": {
            "description": "schema section",
            "oneOf": [
                {
                    "description": "schema section SAID",
                    "type": "string"
                },
                {
                    "description": "schema detail",
                    "type": "object"
                }
            ]
        },
        "a": {
            "oneOf": [
                {
                    "description": "Attributes block SAID",
                    "type": "string"
                },
                {
                    "$id": <Insert Block SAID>,
                    "description": "Attributes block",
                    "type": "object",
                    "properties": {
                        "d": {
                            "description": "Attributes block SAID",
                            "type": "string"
                        },
                        "i": {
                            "description": "Authorized Identifier is a string that ends in the AID of the controller, making it an AID controlled identifier. Everything prior to the AID is regarded as the namespace portion of the identifier",
                            "type": "string"
                        },
                        "u": {
                            "description": "One time use nonce",
                            "type": "string"
                        },
                        "dt": {
                            "description": "Authorization date time",
                            "type": "string",
                            "format": "date-time"
                        }
                    },
                    "additionalProperties": false,
                    "required": [
                        "d",
                        "i",
                        "dt"
                    ]
                }
            ]
        },
        "r": {
            "oneOf": [
                {
                    "description": "Rules block SAID",
                    "type": "string"
                },
                {
                    "$id": <Insert SAID of rules block>,
                    "description": "Rules block",
                    "type": "object",
                    "properties": {
                        "d": {
                            "description": "Rules block SAID",
                            "type": "string"
                        },
                        "usageDisclaimer": {
                            "description": "Usage Disclaimer",
                            "type": "object",
                            "properties": {
                                "l": {
                                    "description": "Clarification regarding control",
                                    "type": "string",
                                    "const": "This attestation only asserts an authorization from the controller of the AID, that the AID controlled namespaced identifier is known and authorized by the controller. It does not assert that the controller of this AID has control of the infrastructure or other systems related to the hosting of the namespaced AID identifier. For instance, a did:webs DID is controlled by an AID but the domain name hosting that DID is not necessarily under the control of the AID controller."
                                }
                            }
                        },
                        "issuanceDisclaimer": {
                            "description": "Issuance Disclaimer",
                            "type": "object",
                            "properties": {
                                "l": {
                                    "description": "Accuracy of information",
                                    "type": "string",
                                    "const": "All information in a valid and non-revoked Identifier Authorization assertion is accurate as of the date specified."
                                }
                            }
                        },
                        "privacyDisclaimer": {
                            "description": "Privacy Disclaimer",
                            "type": "object",
                            "properties": {
                                "l": {
                                    "description": "Privacy-preservation expectations",
                                    "type": "string",
                                    "const": "If the assertioin is blinded with the UUID field the assertion should be used in a non-correlating and privacy-preserving manner."
                                }
                            }
                        }
                    },
                    "additionalProperties": false,
                    "required": [
                        "d",
                        "usageDisclaimer",
                        "issuanceDisclaimer",
                        "privacyDisclaimer"
                    ]
                }
            ]
        }
    },
    "additionalProperties": false,
    "required": [
        "v",
        "d",
        "i",
        "ri",
        "s",
        "a",
        "r"
    ]
}